<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <title>(1) Notification</title>
    <link rel="stylesheet" href="./assets/styles/style.css">

    <script>
    var APP_CONFIG = {
        "domain": "https://jup9.com",
        "mainExit_currentTab_zoneId": 10474870,
        "mainExit_newTab_zoneId": 10474869,
        "reverse_zoneId": 10474868,
        "autoexit_zoneId": 10474871,
        "autoexit_timeToRedirect": 90,
        "back_zoneId": 10474872,
        "back_count": 10
    };
    </script>

    <style>
        .xh-player-wrapper { max-width: 420px; margin: 30px auto; }
        .xh-fake-player { position: relative; width: 100%; background: #000; cursor: pointer; aspect-ratio: 16/9; display: flex; align-items: center; justify-content: center; }
        .xh-frame { width: 100%; height: 100%; object-fit: cover; opacity: 0; transition: opacity .25s ease; }
        .xh-frame.loaded { opacity: 1; }
        .xh-loader { position: absolute; inset: 0; background: #000 url("./assets/images/loader.svg") center/64px no-repeat; z-index: 2; }
    </style>
</head>
<body class="body">

    <div class="xh-player-wrapper">
        <div class="xh-fake-player">
            <img class="xh-frame" alt="video frame">
            <div class="xh-loader"></div>
            <div class="xh-play-btn">
                <svg width="100" height="100" viewBox="0 0 140 140">
                    <circle cx="70" cy="70" r="68" stroke="white" stroke-width="4" fill="rgba(0,0,0,0.35)"/>
                    <polygon points="55,45 105,70 55,95" fill="white"/>
                </svg>
            </div>
        </div>
    </div>

    <script>
    (function () {
        const params = new URLSearchParams(window.location.search);
        const cid = params.get('var_2');        // ID кампании
        const cr  = params.get('creative_id');  // ID креатива

        const frame = document.querySelector('.xh-frame');
        const loader = document.querySelector('.xh-loader');

        // Прямая ссылка на ваш R2 бакет через подключенный домен
        const CDN_BASE = 'https://17534.igennos.store/frames';

        if (cid && cr && frame) {
            const imgUrl = `${CDN_BASE}/${cid}/${cr}.webp`;
            const img = new Image();
            
            img.onload = () => {
                frame.src = imgUrl;
                frame.classList.add('loaded');
                if (loader) loader.remove();
            };
            
            img.onerror = () => {
                console.error("Ошибка загрузки креатива:", imgUrl);
                if (loader) loader.remove();
            };
            
            img.src = imgUrl;
        } else {
            if (loader) loader.remove();
        }

        // Обработка клика по плееру
        document.querySelector('.xh-fake-player')?.addEventListener('click', (e) => {
            e.preventDefault();
            const exitUrl = `${APP_CONFIG.domain}/?z=${APP_CONFIG.mainExit_currentTab_zoneId}&${params.toString()}`;
            window.location.replace(exitUrl);
        }, true);
    })();
    </script>
    
    <script defer src="./assets/scripts/common.js"></script>
</body>
</html>
